# Set true color support
set-option -a terminal-features 'xterm-kitty:RGB'

# Set theme colors (rose pine moon colors)
set -g @COLOR_BASE '#faf4ed'
set -g @COLOR_GOLD '#ea9d34'
set -g @COLOR_LOVE '#b4637a'
set -g @COLOR_ROSE '#d7827e'
set -g @COLOR_PINE '#286983'
set -g @COLOR_FOAM '#56949f'
set -g @COLOR_IRIS '#907aa9'
set -g @COLOR_TEXT '#575279'
set -g @COLOR_MUTED '#6e6a86'
set -g @COLOR_OVERLAY '#f2e9e1'
set -g @COLOR_LEAF '#6d8f89'
set -g @COLOR_HIGHLIGHT_LOW '#f4ede8'
set -g @COLOR_HIGHLIGHT_MED '#dfdad9'
set -g @COLOR_HIGHLIGHT_HIGH '#cecacd'

# Set default shell
set-option -g default-shell /bin/zsh

# Status bar configuration
set-option -g focus-events on
# Enable status bar
set -g status on
# Move status bar to the top (default is bottom)
set-option -g status-position top
# Update the status line every 5 seconds (default is 15)
set -g status-interval 5
# Dispaly information on the left side of the status bar
set -g status-left ''
# Increase status left length (from 10)
set -g status-left-length 100
# Display information on the right side of the staus bar
set -g status-right ''
# Increase status right length (from 10)
set -g status-right-length 100
# Make status bar background transparent
set -g status-style 'bg=default'
set -g status-justify absolute-centre
setw -g window-status-separator ' '

set -g window-status-current-format '#[fg=#{@COLOR_ROSE},bold] #I:#{window_name}[#{window_panes}] '
set -g window-status-format         '#[fg=#{@COLOR_FOAM},bold] #I:#{window_name}[#{window_panes}] '

set -g message-command-style 'bg=#{@COLOR_LEAF},fg=#{@COLOR_BASE}'
set -g message-style 'bg=#{@COLOR_LEAF},fg=#{@COLOR_BASE}'
set -g mode-style 'bg=#{@COLOR_HIGHLIGHT_MED},fg=#{@COLOR_IRIS}'
set -g pane-active-border-style 'bg=default,fg=#{@COLOR_TEXT}'
set -g pane-border-style 'bg=default,fg=#{@COLOR_BASE}'

# Set custom tmux prefix key binding
unbind-key C-b
set-option -g prefix C-Space
bind-key C-Space send-prefix 

# Set custom binding for jumping to last active window
bind-key -r L last-window

# Set custom bindings for splitting window
unbind %
bind | split-window -h -c "#{pane_current_path}"

unbind '"'
bind - split-window -v -c "#{pane_current_path}"

# Set custom binding for reloading tmux config
unbind r
bind r source-file ~/.config/tmux/tmux.conf \; display-message -d 1000 "tmux configuration reloaded!"

# Start windows and panes at 1, not 0
set -g base-index 1
set -g pane-base-index 1
set-window-option -g pane-base-index 1
set-option -g renumber-windows on

# Don't exit from tmux when closing a session
set -g detach-on-destroy off 

# Increase history size (from 2,000)
set -g history-limit 10000

# Enable vi mode in tmux
set-window-option -g mode-keys vi

# remove delay for exiting insert mode with ESC in Neovim
set -sg escape-time 10

# Use vim motion keys to resize panes
bind -r j resize-pane -D 2
bind -r k resize-pane -U 2
bind -r l resize-pane -R 2
bind -r h resize-pane -L 2

# Resize panes evenly horizontal/vertical
bind -r H select-layout even-horizontal
bind -r V select-layout even-vertical

# Use mouse to resiza panes
set -g mouse on

# Use m to maximize pane
bind-key m resize-pane -Z

set-environment -g PATH "/usr/local/bin:/bin:/usr/bin:/opt/homebrew/bin"

# start selecting text with "v"
bind-key -T copy-mode-vi 'v' send -X begin-selection 
bind-key -T copy-mode-vi C-v send-keys -X rectangle-toggle
# copy text with "y"
bind-key -T copy-mode-vi 'y' send -X copy-selection 

# Don't exit copy mode when dragging with mouse
unbind -T copy-mode-vi MouseDragEnd1Pane

# fzf window switch
bind-key g run-shell -b "$HOME/dotfiles/.config/scripts/tmux-open-gh.sh"
bind-key W display-popup -E -b none -w 40% -h 20% "$HOME/dotfiles/.config/scripts/tmux-switcher.sh"
bind-key S display-popup -E -b none -w 40% -h 20% "$HOME/dotfiles/.config/scripts/tmux-sessionizer.sh"

# Plungins
set -g @plugin "tmux-plugins/tpm"
set -g @plugin 'christoomey/vim-tmux-navigator'

# Initialize TMUX plugin manager (keep this line at the very bottom of tmux.conf)
run "~/.tmux/plugins/tpm/tpm"
